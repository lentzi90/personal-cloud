---
# Source: nextcloud-aio-helm-chart/templates/nextcloud-aio-namespace-namespace.yaml
apiVersion: v1
kind: Namespace
metadata:
  name: nextcloud
  namespace: nextcloud
spec: {}
---
# Source: nextcloud-aio-helm-chart/templates/nextcloud-aio-apache-persistentvolumeclaim.yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  labels:
    io.kompose.service: nextcloud-aio-apache
  name: nextcloud-aio-apache
  namespace: nextcloud
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi
---
# Source: nextcloud-aio-helm-chart/templates/nextcloud-aio-clamav-persistentvolumeclaim.yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  labels:
    io.kompose.service: nextcloud-aio-clamav
  name: nextcloud-aio-clamav
  namespace: nextcloud
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi
---
# Source: nextcloud-aio-helm-chart/templates/nextcloud-aio-database-dump-persistentvolumeclaim.yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  labels:
    io.kompose.service: nextcloud-aio-database-dump
  name: nextcloud-aio-database-dump
  namespace: nextcloud
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi
---
# Source: nextcloud-aio-helm-chart/templates/nextcloud-aio-database-persistentvolumeclaim.yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  labels:
    io.kompose.service: nextcloud-aio-database
  name: nextcloud-aio-database
  namespace: nextcloud
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi
---
# Source: nextcloud-aio-helm-chart/templates/nextcloud-aio-elasticsearch-persistentvolumeclaim.yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  labels:
    io.kompose.service: nextcloud-aio-elasticsearch
  name: nextcloud-aio-elasticsearch
  namespace: nextcloud
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi
---
# Source: nextcloud-aio-helm-chart/templates/nextcloud-aio-nextcloud-data-persistentvolumeclaim.yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  labels:
    io.kompose.service: nextcloud-aio-nextcloud-data
  name: nextcloud-aio-nextcloud-data
  namespace: nextcloud
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 5Gi
---
# Source: nextcloud-aio-helm-chart/templates/nextcloud-aio-nextcloud-persistentvolumeclaim.yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  labels:
    io.kompose.service: nextcloud-aio-nextcloud
  name: nextcloud-aio-nextcloud
  namespace: nextcloud
spec:
  accessModes:
    - ReadWriteMany
  resources:
    requests:
      storage: 5Gi
---
# Source: nextcloud-aio-helm-chart/templates/nextcloud-aio-nextcloud-trusted-cacerts-persistentvolumeclaim.yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  labels:
    io.kompose.service: nextcloud-aio-nextcloud-trusted-cacerts
  name: nextcloud-aio-nextcloud-trusted-cacerts
  namespace: nextcloud
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi
---
# Source: nextcloud-aio-helm-chart/templates/nextcloud-aio-onlyoffice-persistentvolumeclaim.yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  labels:
    io.kompose.service: nextcloud-aio-onlyoffice
  name: nextcloud-aio-onlyoffice
  namespace: nextcloud
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi
---
# Source: nextcloud-aio-helm-chart/templates/nextcloud-aio-redis-persistentvolumeclaim.yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  labels:
    io.kompose.service: nextcloud-aio-redis
  name: nextcloud-aio-redis
  namespace: nextcloud
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi
---
# Source: nextcloud-aio-helm-chart/templates/nextcloud-aio-apache-service.yaml
apiVersion: v1
kind: Service
metadata:
  annotations:
    kompose.cmd: kompose convert -c -f latest.yml --namespace nextcloud
    kompose.version: 1.31.2 (a92241f79)
  labels:
    io.kompose.service: nextcloud-aio-apache
  name: nextcloud-aio-apache
  namespace: nextcloud
spec:
  type: LoadBalancer
  externalTrafficPolicy: Local
  ports:
    - name: "443"
      port: 443
      targetPort: 443
    - name: 443-udp
      port: 443
      protocol: UDP
      targetPort: 443
  selector:
    io.kompose.service: nextcloud-aio-apache
---
# Source: nextcloud-aio-helm-chart/templates/nextcloud-aio-collabora-service.yaml
apiVersion: v1
kind: Service
metadata:
  annotations:
    kompose.cmd: kompose convert -c -f latest.yml --namespace nextcloud
    kompose.version: 1.31.2 (a92241f79)
  labels:
    io.kompose.service: nextcloud-aio-collabora
  name: nextcloud-aio-collabora
  namespace: nextcloud
spec:
  ports:
    - name: "9980"
      port: 9980
      targetPort: 9980
  selector:
    io.kompose.service: nextcloud-aio-collabora
---
# Source: nextcloud-aio-helm-chart/templates/nextcloud-aio-database-service.yaml
apiVersion: v1
kind: Service
metadata:
  annotations:
    kompose.cmd: kompose convert -c -f latest.yml --namespace nextcloud
    kompose.version: 1.31.2 (a92241f79)
  labels:
    io.kompose.service: nextcloud-aio-database
  name: nextcloud-aio-database
  namespace: nextcloud
spec:
  ports:
    - name: "5432"
      port: 5432
      targetPort: 5432
  selector:
    io.kompose.service: nextcloud-aio-database
---
# Source: nextcloud-aio-helm-chart/templates/nextcloud-aio-nextcloud-service.yaml
apiVersion: v1
kind: Service
metadata:
  annotations:
    kompose.cmd: kompose convert -c -f latest.yml --namespace nextcloud
    kompose.version: 1.31.2 (a92241f79)
  labels:
    io.kompose.service: nextcloud-aio-nextcloud
  name: nextcloud-aio-nextcloud
  namespace: nextcloud
spec:
  ports:
    - name: "9000"
      port: 9000
      targetPort: 9000
    - name: "9001"
      port: 9001
      targetPort: 9001
  selector:
    io.kompose.service: nextcloud-aio-nextcloud
---
# Source: nextcloud-aio-helm-chart/templates/nextcloud-aio-notify-push-service.yaml
apiVersion: v1
kind: Service
metadata:
  annotations:
    kompose.cmd: kompose convert -c -f latest.yml --namespace nextcloud
    kompose.version: 1.31.2 (a92241f79)
  labels:
    io.kompose.service: nextcloud-aio-notify-push
  name: nextcloud-aio-notify-push
  namespace: nextcloud
spec:
  ports:
    - name: "7867"
      port: 7867
      targetPort: 7867
  selector:
    io.kompose.service: nextcloud-aio-notify-push
---
# Source: nextcloud-aio-helm-chart/templates/nextcloud-aio-redis-service.yaml
apiVersion: v1
kind: Service
metadata:
  annotations:
    kompose.cmd: kompose convert -c -f latest.yml --namespace nextcloud
    kompose.version: 1.31.2 (a92241f79)
  labels:
    io.kompose.service: nextcloud-aio-redis
  name: nextcloud-aio-redis
  namespace: nextcloud
spec:
  ports:
    - name: "6379"
      port: 6379
      targetPort: 6379
  selector:
    io.kompose.service: nextcloud-aio-redis
---
# Source: nextcloud-aio-helm-chart/templates/nextcloud-aio-apache-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    kompose.cmd: kompose convert -c -f latest.yml --namespace nextcloud
    kompose.version: 1.31.2 (a92241f79)
  labels:
    io.kompose.service: nextcloud-aio-apache
  name: nextcloud-aio-apache
  namespace: nextcloud
spec:
  replicas: 1
  selector:
    matchLabels:
      io.kompose.service: nextcloud-aio-apache
  template:
    metadata:
      annotations:
        kompose.cmd: kompose convert -c -f latest.yml --namespace nextcloud
        kompose.version: 1.31.2 (a92241f79)
      labels:
        io.kompose.network/nextcloud-aio: "true"
        io.kompose.service: nextcloud-aio-apache
    spec:
      initContainers:
        - name: init-volumes
          image: alpine
          command:
            - chmod
            - "777"
            - /nextcloud-aio-nextcloud
            - /nextcloud-aio-apache
          volumeMounts:
            - name: nextcloud-aio-apache
              mountPath: /nextcloud-aio-apache
            - name: nextcloud-aio-nextcloud
              mountPath: /nextcloud-aio-nextcloud
      containers:
        - env:
            - name: APACHE_MAX_SIZE
              value: "10737418240"
            - name: APACHE_MAX_TIME
              value: "3600"
            - name: APACHE_PORT
              value: "443"
            - name: COLLABORA_HOST
              value: nextcloud-aio-collabora
            - name: NC_DOMAIN
              value: "yourdomain.com"
            - name: NEXTCLOUD_HOST
              value: nextcloud-aio-nextcloud
            - name: NOTIFY_PUSH_HOST
              value: nextcloud-aio-notify-push
            - name: ONLYOFFICE_HOST
              value: nextcloud-aio-onlyoffice
            - name: TALK_HOST
              value: nextcloud-aio-talk
            - name: TZ
              value: "Europe/Helsinki"
          image: nextcloud/aio-apache:20231113_125854-latest
          name: nextcloud-aio-apache
          ports:
            - containerPort: 443
              protocol: TCP
            - containerPort: 443
              protocol: UDP
          volumeMounts:
            - mountPath: /var/www/html
              name: nextcloud-aio-nextcloud
              readOnly: true
            - mountPath: /mnt/data
              name: nextcloud-aio-apache
      volumes:
        - name: nextcloud-aio-nextcloud
          persistentVolumeClaim:
            claimName: nextcloud-aio-nextcloud
        - name: nextcloud-aio-apache
          persistentVolumeClaim:
            claimName: nextcloud-aio-apache
---
# Source: nextcloud-aio-helm-chart/templates/nextcloud-aio-collabora-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    kompose.cmd: kompose convert -c -f latest.yml --namespace nextcloud
    kompose.version: 1.31.2 (a92241f79)
  labels:
    io.kompose.service: nextcloud-aio-collabora
  name: nextcloud-aio-collabora
  namespace: nextcloud
spec:
  replicas: 1
  selector:
    matchLabels:
      io.kompose.service: nextcloud-aio-collabora
  template:
    metadata:
      annotations:
        kompose.cmd: kompose convert -c -f latest.yml --namespace nextcloud
        kompose.version: 1.31.2 (a92241f79)
      labels:
        io.kompose.network/nextcloud-aio: "true"
        io.kompose.service: nextcloud-aio-collabora
    spec:
      containers:
        - env:
            - name: DONT_GEN_SSL_CERT
              value: "1"
            - name: TZ
              value: "Europe/Helsinki"
            - name: aliasgroup1
              value: https://yourdomain.com:443
            - name: dictionaries
              value: "de_DE en_GB en_US es_ES fr_FR it nl pt_BR pt_PT ru"
            - name: extra_params
              value: --o:ssl.enable=false --o:ssl.termination=true --o:mount_jail_tree=false --o:logging.level=warning --o:home_mode.enable=true --o:security.seccomp=true --o:remote_font_config.url=https://yourdomain.com/apps/richdocuments/settings/fonts.json
            - name: server_name
              value: "yourdomain.com"
          image: nextcloud/aio-collabora:20231113_125854-latest
          name: nextcloud-aio-collabora
          ports:
            - containerPort: 9980
              protocol: TCP
---
# Source: nextcloud-aio-helm-chart/templates/nextcloud-aio-database-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    kompose.cmd: kompose convert -c -f latest.yml --namespace nextcloud
    kompose.version: 1.31.2 (a92241f79)
  labels:
    io.kompose.service: nextcloud-aio-database
  name: nextcloud-aio-database
  namespace: nextcloud
spec:
  replicas: 1
  selector:
    matchLabels:
      io.kompose.service: nextcloud-aio-database
  template:
    metadata:
      annotations:
        kompose.cmd: kompose convert -c -f latest.yml --namespace nextcloud
        kompose.version: 1.31.2 (a92241f79)
      labels:
        io.kompose.network/nextcloud-aio: "true"
        io.kompose.service: nextcloud-aio-database
    spec:
      initContainers:
        - name: init-subpath
          image: alpine
          command:
            - mkdir
            - "-p"
            - /nextcloud-aio-database/data
            - /nextcloud-aio-database
            - /nextcloud-aio-database-dump
          volumeMounts:
            - name: nextcloud-aio-database-dump
              mountPath: /nextcloud-aio-database-dump
            - name: nextcloud-aio-database
              mountPath: /nextcloud-aio-database
        - name: init-volumes
          image: alpine
          command:
            - chown
            - 999:999
            - "-R"
            - /nextcloud-aio-database
            - /nextcloud-aio-database-dump
          volumeMounts:
            - name: nextcloud-aio-database-dump
              mountPath: /nextcloud-aio-database-dump
            - name: nextcloud-aio-database
              mountPath: /nextcloud-aio-database
      containers:
        - env:
            - name: PGTZ
              value: "Europe/Helsinki"
            - name: POSTGRES_DB
              value: nextcloud_database
            - name: POSTGRES_PASSWORD
              value: "TODO"
            - name: POSTGRES_USER
              value: nextcloud
            - name: TZ
              value: "Europe/Helsinki"
          image: nextcloud/aio-postgresql:20231113_125854-latest
          name: nextcloud-aio-database
          ports:
            - containerPort: 5432
              protocol: TCP
          volumeMounts:
            - mountPath: /var/lib/postgresql/data
              subPath: data
              name: nextcloud-aio-database
            - mountPath: /mnt/data
              name: nextcloud-aio-database-dump
      terminationGracePeriodSeconds: 1800
      volumes:
        - name: nextcloud-aio-database
          persistentVolumeClaim:
            claimName: nextcloud-aio-database
        - name: nextcloud-aio-database-dump
          persistentVolumeClaim:
            claimName: nextcloud-aio-database-dump
---
# Source: nextcloud-aio-helm-chart/templates/nextcloud-aio-nextcloud-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    kompose.cmd: kompose convert -c -f latest.yml --namespace nextcloud
    kompose.version: 1.31.2 (a92241f79)
  labels:
    io.kompose.service: nextcloud-aio-nextcloud
  name: nextcloud-aio-nextcloud
  namespace: nextcloud
spec:
  replicas: 1
  selector:
    matchLabels:
      io.kompose.service: nextcloud-aio-nextcloud
  template:
    metadata:
      annotations:
        kompose.cmd: kompose convert -c -f latest.yml --namespace nextcloud
        kompose.version: 1.31.2 (a92241f79)
      labels:
        io.kompose.network/nextcloud-aio: "true"
        io.kompose.service: nextcloud-aio-nextcloud
    spec:
      initContainers:
        - name: init-volumes
          image: alpine
          command:
            - chmod
            - "777"
            - /nextcloud-aio-nextcloud
            - /nextcloud-aio-nextcloud-trusted-cacerts
          volumeMounts:
            - name: nextcloud-aio-nextcloud-trusted-cacerts
              mountPath: /nextcloud-aio-nextcloud-trusted-cacerts
            - name: nextcloud-aio-nextcloud
              mountPath: /nextcloud-aio-nextcloud
      containers:
        - env:
            - name: ADDITIONAL_APKS
              value: "imagemagick"
            - name: ADDITIONAL_PHP_EXTENSIONS
              value: "imagick"
            - name: ADMIN_PASSWORD
              value: "TODO"
            - name: ADMIN_USER
              value: admin
            - name: APACHE_PORT
              value: "443"
            - name: CLAMAV_ENABLED
              value: "no"
            - name: CLAMAV_HOST
              value: nextcloud-aio-clamav
            - name: COLLABORA_ENABLED
              value: "yes"
            - name: COLLABORA_HOST
              value: nextcloud-aio-collabora
            - name: FULLTEXTSEARCH_ENABLED
              value: "no"
            - name: FULLTEXTSEARCH_HOST
              value: nextcloud-aio-fulltextsearch
            - name: FULLTEXTSEARCH_PASSWORD
              value: "TODO"
            - name: IMAGINARY_ENABLED
              value: "no"
            - name: IMAGINARY_HOST
              value: nextcloud-aio-imaginary
            - name: INSTALL_LATEST_MAJOR
              value: "false"
            - name: NC_DOMAIN
              value: "yourdomain.com"
            - name: NEXTCLOUD_DATA_DIR
              value: /mnt/ncdata
            - name: ONLYOFFICE_ENABLED
              value: "no"
            - name: ONLYOFFICE_HOST
              value: nextcloud-aio-onlyoffice
            - name: ONLYOFFICE_SECRET
              value: "TODO"
            - name: OVERWRITEHOST
              value: "yourdomain.com"
            - name: OVERWRITEPROTOCOL
              value: https
            - name: PHP_MAX_TIME
              value: "3600"
            - name: PHP_MEMORY_LIMIT
              value: "512M"
            - name: PHP_UPLOAD_LIMIT
              value: "10G"
            - name: POSTGRES_DB
              value: nextcloud_database
            - name: POSTGRES_HOST
              value: nextcloud-aio-database
            - name: POSTGRES_PASSWORD
              value: "TODO"
            - name: POSTGRES_USER
              value: nextcloud
            - name: RECORDING_SECRET
              value: "TODO"
            - name: REDIS_HOST
              value: nextcloud-aio-redis
            - name: REDIS_HOST_PASSWORD
              value: "TODO"
            - name: REMOVE_DISABLED_APPS
              value: "true"
            - name: SIGNALING_SECRET
              value: "TODO"
            - name: STARTUP_APPS
              value: "deck twofactor_totp tasks calendar contacts notes"
            - name: TALK_ENABLED
              value: "no"
            - name: TALK_PORT
              value: "3478"
            - name: TALK_RECORDING_ENABLED
              value: "no"
            - name: TALK_RECORDING_HOST
              value: nextcloud-aio-talk-recording
            - name: TRUSTED_CACERTS_DIR
              value: ""
            - name: TURN_SECRET
              value: "TODO"
            - name: TZ
              value: "Europe/Helsinki"
            - name: UPDATE_NEXTCLOUD_APPS
              value: "false"
          image: nextcloud/aio-nextcloud:20231113_125854-latest
          name: nextcloud-aio-nextcloud
          ports:
            - containerPort: 9000
              protocol: TCP
            - containerPort: 9001
              protocol: TCP
          volumeMounts:
            - mountPath: /var/www/html
              name: nextcloud-aio-nextcloud
            - mountPath: /mnt/ncdata
              name: nextcloud-aio-nextcloud-data
            - mountPath: /usr/local/share/ca-certificates
              name: nextcloud-aio-nextcloud-trusted-cacerts
              readOnly: true
      volumes:
        - name: nextcloud-aio-nextcloud
          persistentVolumeClaim:
            claimName: nextcloud-aio-nextcloud
        - name: nextcloud-aio-nextcloud-data
          persistentVolumeClaim:
            claimName: nextcloud-aio-nextcloud-data
        - name: nextcloud-aio-nextcloud-trusted-cacerts
          persistentVolumeClaim:
            claimName: nextcloud-aio-nextcloud-trusted-cacerts
---
# Source: nextcloud-aio-helm-chart/templates/nextcloud-aio-notify-push-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    kompose.cmd: kompose convert -c -f latest.yml --namespace nextcloud
    kompose.version: 1.31.2 (a92241f79)
  labels:
    io.kompose.service: nextcloud-aio-notify-push
  name: nextcloud-aio-notify-push
  namespace: nextcloud
spec:
  replicas: 1
  selector:
    matchLabels:
      io.kompose.service: nextcloud-aio-notify-push
  template:
    metadata:
      annotations:
        kompose.cmd: kompose convert -c -f latest.yml --namespace nextcloud
        kompose.version: 1.31.2 (a92241f79)
      labels:
        io.kompose.network/nextcloud-aio: "true"
        io.kompose.service: nextcloud-aio-notify-push
    spec:
      initContainers:
        - name: init-volumes
          image: alpine
          command:
            - chmod
            - "777"
            - /nextcloud-aio-nextcloud
          volumeMounts:
            - name: nextcloud-aio-nextcloud
              mountPath: /nextcloud-aio-nextcloud
      containers:
        - env:
            - name: NC_DOMAIN
              value: "yourdomain.com"
            - name: NEXTCLOUD_HOST
              value: nextcloud-aio-nextcloud
            - name: POSTGRES_DB
              value: nextcloud_database
            - name: POSTGRES_HOST
              value: nextcloud-aio-database
            - name: POSTGRES_PASSWORD
              value: "TODO"
            - name: POSTGRES_USER
              value: nextcloud
            - name: REDIS_HOST
              value: nextcloud-aio-redis
            - name: REDIS_HOST_PASSWORD
              value: "TODO"
          image: nextcloud/aio-notify-push:20231113_125854-latest
          name: nextcloud-aio-notify-push
          ports:
            - containerPort: 7867
              protocol: TCP
          volumeMounts:
            - mountPath: /nextcloud
              name: nextcloud-aio-nextcloud
              readOnly: true
      volumes:
        - name: nextcloud-aio-nextcloud
          persistentVolumeClaim:
            claimName: nextcloud-aio-nextcloud
---
# Source: nextcloud-aio-helm-chart/templates/nextcloud-aio-redis-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    kompose.cmd: kompose convert -c -f latest.yml --namespace nextcloud
    kompose.version: 1.31.2 (a92241f79)
  labels:
    io.kompose.service: nextcloud-aio-redis
  name: nextcloud-aio-redis
  namespace: nextcloud
spec:
  replicas: 1
  selector:
    matchLabels:
      io.kompose.service: nextcloud-aio-redis
  template:
    metadata:
      annotations:
        kompose.cmd: kompose convert -c -f latest.yml --namespace nextcloud
        kompose.version: 1.31.2 (a92241f79)
      labels:
        io.kompose.network/nextcloud-aio: "true"
        io.kompose.service: nextcloud-aio-redis
    spec:
      initContainers:
        - name: init-volumes
          image: alpine
          command:
            - chmod
            - "777"
            - /nextcloud-aio-redis
          volumeMounts:
            - name: nextcloud-aio-redis
              mountPath: /nextcloud-aio-redis
      containers:
        - env:
            - name: REDIS_HOST_PASSWORD
              value: "TODO"
            - name: TZ
              value: "Europe/Helsinki"
          image: nextcloud/aio-redis:20231113_125854-latest
          name: nextcloud-aio-redis
          ports:
            - containerPort: 6379
              protocol: TCP
          volumeMounts:
            - mountPath: /data
              name: nextcloud-aio-redis
      volumes:
        - name: nextcloud-aio-redis
          persistentVolumeClaim:
            claimName: nextcloud-aio-redis
